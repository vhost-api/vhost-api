.table-wrapper
  %table.table.table-triped
    %caption Mailaccounts
    %thead
      %tr
        %th= 'enabled'
        %th= 'email'
        %th= 'realname'
        %th= 'receiving'
        %th= 'usage'
        %th= 'quota'
        %th
    %tbody
      -# - policy_scope(MailAccount).each do |mailaccount|
      - @mailaccounts.each do |mailaccount|
        - id = mailaccount['id']
        %tr
          %td.icon
            - enable_href_suffix = mailaccount['enabled'] ? 'disable' : 'enable'
            - en = 'icon-check item-enabled'
            - dis = 'icon-cross item-disabled'
            - enable_class_suffix = mailaccount['enabled'] ? en : dis
            - enable_link_text = mailaccount['enabled'] ? 'yes' : 'no'
            %a{ href: "/mail/accounts/#{id}/#{enable_href_suffix}",
              class: "icon #{enable_class_suffix}" }= enable_link_text
          %td
            %a{ href: "/mail/accounts/#{id}/edit" }
              = mailaccount['email']
          %td= mailaccount['realname']
          %td.icon
            - rcv_enabled = mailaccount['receiving_enabled']
            - en_recv_href_suf = rcv_enabled ? 'dis_recv' : 'en_recv'
            - en = 'icon-check item-enabled'
            - dis = 'icon-cross item-disabled'
            - en_recv_class_suf = mailaccount['receiving_enabled'] ? en : dis
            - en_recv_link_txt = mailaccount['receiving_enabled'] ? 'yes' : 'no'
            %a{ href: "/mail/accounts/#{id}/#{en_recv_href_suf}",
              class: "icon #{en_recv_class_suf}" }= en_recv_link_txt
          %td
            .progress
              - progress_class = 'progress-bar progress-bar-info'
              - thresh_warn = settings.threshholds[:display][:mailquota_warn]
              - thresh_crit = settings.threshholds[:display][:mailquota_crit]
              - if mailaccount['quotausage_rel'] >= thresh_warn
                - progress_class = 'progress-bar progress-bar-warning'
              - if mailaccount['quotausage_rel'] >= thresh_crit
                - progress_class = 'progress-bar progress-bar-danger'
              %div{ class: progress_class,
                    'role': 'progress',
                    'aria-valuemin': '0',
                    'aria-valuemax': '100',
                    style: "width:#{mailaccount['quotausage_rel']}%" }
                %span
                  = Filesize.from("#{mailaccount['quotausage']} B").pretty
          %td.number= Filesize.from("#{mailaccount['quota']} B").pretty
          %td.icon.item-delete
            - delete_path = "/mail/accounts/#{id}/delete"
            %a.icon.icon-trash.item-delete{ href: delete_path } delete
